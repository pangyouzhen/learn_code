# 向量召回算法

## 概述

向量搜索算法主要用来做召回的相关功能，召回比较相似的内容

## 主流方法

### LSH

#### hash函数+hash表 （非主流方法）

### Tree/Space parition

开源工具

#### annoy

[文章链接](https://blog.csdn.net/hero_fantao/article/details/70245387)

1. annoy的构建(**不断执行2kmeans聚类过程形成二叉树**)
    1. 随机选择两个点,执行k=2的kmeans聚类过程,得到两个收敛中心
    1. 两个中心构建一条垂直的线,进行平面分割
    1. 在各个划分的子空间不停的执行上述过程
    1. 最终形成一个二叉树
1. annoy的查询(**根据二叉树节点进行查询**)
    1. 根据二叉树不断进行下一步查询
    1. 查询过程最终落到叶子节点的数据节点数小于 Top N相似邻居节点数目怎么办: 如果分割超平面的两边都很相似，那可以两边都遍历
    1. 两个相近的数据节点划分到二叉树不同分支上怎么办: 构建多个二叉树, 形成森林
1. 取topN
    1. 所有的树节点都放到集合里面,去重, 然后计算和查询点距离，进行排序

### 量化的方法

### 图遍历的方法

开源工具

[nsg](https://blog.csdn.net/chansonzhang/article/details/107775706)

1. nsg的构建
    1. 通过kNN 构建MRNG(单调相对邻域图)
    1. 时间复杂度比较接近 O(logn)
1. nsg的查询(图的搜索算法,**对目标节点进行贪婪搜索**)
    1. 深度优先算法和广度优先算法不合适,这两个性能比较低,精确度很高
    1. 随机选择初始节点,对周边节点找离目标节点最近的点
1. nsg的问题
    1. msnet的稀疏性过高,导致搜索性能比较差
    1. 索引的复杂度仍然很高

## 工具

### faiss

1. faiss 主要使用PCA和PQ对向量进行降维和编码

#### PCA

#### PQ

PQ(纵向对维度切分,横向对样本进行kmeans聚类)

#### HNSW 算法（基于图的方法）

#### faiss 中的索引如何进行选择

1.
1.
1.

### milvus 